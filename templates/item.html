$def with (user, item, pack, outdated)
$ qitem = pack.get_item_quality(item)
$if not user:
    $ usern = "Schema"
$else:
    $ usern = user.get_persona() + "'s"
$var title: $project_name - $usern $item["optf2_title_name"]

<div id="header">
  <h1 class="${qitem['str']}_name">
    $if not user:
        $ urlpart = "schema_dump"
        $ plink_user = "from_schema"
        $ idpart = pack.get_item_schema_id(item)
    $else:
        $ plink_user = user.get_id64()
        $ urlpart = "user/{0}".format(plink_user)
        $ idpart = pack.get_item_id(item)
    <a href="${virtual_root}${urlpart}">$usern</a> $:item["optf2_dedicated_name"]
    <a href="${virtual_root}item/${idpart}">
      <img src="${static_prefix}plink_icon.png" alt="Permalink" title="Permalink"/>
    </a>
  </h1>
</div>
<div id="content">
  <div id="item_stats" class="dedicated_item">
  <img id="item_image_large" src="$pack.get_item_image(item, pack.ITEM_IMAGE_LARGE)" alt="$usern $item['optf2_title_name']"/>
  <img id="stat_vertrule" src="${static_prefix}vertical.gif" height="600" width="1" alt="divider"/>
  <div id="item_attrs">
  $ item_wiki_url = wiki_url + encode_url(pack.get_item_name(item))
  <div class="item_neutral_attr" style="font-weight: normal;">
    $ level = pack.get_item_level(item)
    $if not user and level == 0:
      $ level = item["optf2_level"]
    Level $level $pack.get_item_type(item)
  </div>
  $if item["optf2_description"]:
      <div class="item_neutral_attr" style="font-weight: normal;">
        $item["optf2_description"]
      </div>
  $for attr in item["optf2_attrs"]:
      $ desc = pack.format_attribute_description(attr)
      <div class="item_${pack.get_attribute_type(attr)}_attr">
        $if "optf2_gift_from" in item and pack.get_attribute_name(attr) == "gifter account id":
            Gift from <a href="${virtual_root}user/${item['optf2_gift_from']}">$item["optf2_gift_from_persona"]</a>
        $elif "optf2_gift_content" in item and pack.get_attribute_name(attr) == "referenced item def":
            Contains <a href="${virtual_root}item/${item['optf2_gift_content_id']}">$item["optf2_gift_content"]</a>
        $else:
            $:desc.replace("\n", "<br/>")
      </div>
  $if item["optf2_untradeable"]:
      <div class="item_neutral_attr">
        Untradeable
      </div>
  $if user:
      <div class="item_neutral_attr">
        Serial: <span id="item_id">$pack.get_item_id(item)</span>
      </div>
      <div class="item_neutral_attr">
        $ pos = pack.get_item_position(item)
        Position: \
        $if pos <= -1:
            Not in backpack yet!
        $else:
            $pos
      </div>
      <div class="item_neutral_attr">
        $ equipped = pack.get_item_equipped_classes(item)
        Equipped: \
        $if len(equipped) > 0:
            $for ec in equipped:
                <a href="${wiki_url + ec}">
                  <img src="${static_prefix}${ec}_icon.png" title="$ec" alt="$ec"/>
                </a>&nbsp;
        $else:
            No
      </div>
      $ quantity = pack.get_item_quantity(item)
      $if quantity > 1:
          <div class="item_neutral_attr">
            Uses: $quantity
          </div>
      $if outdated:
          <div class="item_negative_attr" style="font-weight: normal">
            This item is out of date, it may have been deleted from $usern backpack.
          </div>
  $else:
      <div class="item_neutral_attr">
        $ schema_id = pack.get_item_schema_id(item);
        ID: <span id="item_id">$schema_id</span>
      </div>
  <br/><a href="$item_wiki_url">Official TF2 Wiki Article</a>
  </div>
  </div>
</div>
