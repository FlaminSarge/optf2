$def with (user, items, erritem = None)
<?xml version="1.0" encoding="UTF-8"?>

<rss version="2.0">
  <channel>
    $ persona = ""
    $if user: $ persona = user.get_persona() + "'s "
    <title>${persona}Backpack</title>
    <generator>$project_name</generator>
    <link>$markup.absolute_url(virtual_root)</link>
    <image>
      <link>$markup.absolute_url(virtual_root)</link>
      <url>$markup.absolute_url(static_prefix + "optf2_icon.png")</url>
      <title>$project_name</title>
    </image>
  $if erritem:
      <item>
	<title>Error</title>
	<description>$erritem</description>
      </item>
  $for item in items:
      $if not item:
          $continue
      <item>
        $ permalink = markup.absolute_url(markup.generate_item_url(item, user))
        $ level = item.optf2["level"]
        $ type = item.optf2["type"]
        $ name = item.get_custom_name()
        $ image = item.optf2["image_url"]
        $if not name:
            $ name = item.get_name()
        <description>Level $level $type<br/><img alt="item-image" src="$image"/></description>
        <title>$:item.optf2["feed_name"]</title>
        <link>$permalink</link>
        <guid isPermaLink="true">$permalink</guid>
      </item>
  </channel>
</rss>
